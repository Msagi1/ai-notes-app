<div class="notes-layout">
  <section class="editor">
    <h2>AI Notes</h2>

    <textarea
      rows="6"
      placeholder="Write your notes or ask something..."
      [(ngModel)]="prompt"
    ></textarea>

    <div class="actions">
      <button (click)="submit()" [disabled]="loadingService.isLoading()">
        {{ loadingService.isLoading() ? 'Thinking...' : 'Ask AI' }}
      </button>

      <button (click)="newNote()" [disabled]="loadingService.isLoading()">
        New
      </button>

      <button
        (click)="saveNote()"
        [disabled]="loadingService.isLoading() || !response()?.trim()"
      >
        Save
      </button>
    </div>

    @if (response()) {
      <div class="response">
        <strong>Response</strong>
        <pre>{{ response() }}</pre>
      </div>
    }
  </section>

  <aside class="history">
    <div class="history-header">
    <h3>History</h3>
  </div>

    @for (n of notesStore.notes(); track n.id) {
      <div class="history-item" [class.selected]="notesStore.selected()?.id === n.id" (click)="loadNote(n.id)">
        <div class="prompt">{{ n.prompt }}</div>
        <div class="date">
          {{ n.createdAt | date:'MMM d, h:mm a' }}
        </div>
      </div>
    } @empty {
      <div class="empty">No saved notes yet.</div>
    }
  </aside>
</div>
